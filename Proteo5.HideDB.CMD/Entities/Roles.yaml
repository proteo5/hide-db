# Description: This file defines the Roles entity for the Proteo5.HideDB.CMD project.
entity: "Roles"
entityversion: "1"
version: "1.0"
description: "Entidad para gestión de roles del sistema"

fields:
  - name: "Id"
    type: "int"
    primaryKey: true
    autoIncrement: true
    required: true
    nullable: false
    description: "Identificador único del rol"
  - name: "Name"
    type: "string"
    maxLength: 50
    required: true
    nullable: false
    description: "Nombre del rol"
  - name: "Description"
    type: "string"
    maxLength: 255
    required: false
    nullable: true
    description: "Descripción del rol"
  - name: "IsActive"
    type: "bool"
    defaultValue: "true"
    required: true
    nullable: false
    description: "Indica si el rol está activo"
  - name: "CreatedAt"
    type: "DateTime"
    defaultValue: "CURRENT_TIMESTAMP_UTC"
    required: true
    nullable: false
    description: "Fecha de creación"
  - name: "UpdatedAt"
    type: "DateTime"
    defaultValue: "CURRENT_TIMESTAMP_UTC"
    required: true
    nullable: false
    description: "Fecha de última actualización"

statements:
  - name: "Insert"
    type: "Insert"
    return: "nothing"
    description: "Crea un nuevo rol"
    sql: |
      INSERT INTO Roles (Name, Description, IsActive)
      VALUES (@Name, @Description, @IsActive);
  - name: "Update"
    type: "Update"
    return: "nothing"
    description: "Actualiza un rol existente"
    sql: |
      UPDATE Roles 
      SET Name = @Name,
          Description = @Description,
          IsActive = @IsActive,
          UpdatedAt = CURRENT_TIMESTAMP_UTC
      WHERE Id = @Id;
  - name: "DeleteById"
    type: "Delete"
    return: "nothing"
    description: "Elimina un rol por ID"
    sql: |
      DELETE FROM Roles 
      WHERE Id = @Id;
  - name: "GetAll"
    type: "Select"
    return: "many"
    description: "Obtiene todos los roles ordenados por nombre"
    sql: |
      SELECT Id, Name, Description, IsActive, CreatedAt, UpdatedAt
      FROM Roles
      ORDER BY Name ASC;
  - name: "GetById"
    type: "Select"
    return: "one"
    description: "Obtiene un rol por su ID"
    sql: |
      SELECT Id, Name, Description, IsActive, CreatedAt, UpdatedAt
      FROM Roles
      WHERE Id = @Id;
  - name: "GetByName"
    type: "Select"
    return: "one"
    description: "Obtiene un rol por su nombre"
    sql: |
      SELECT Id, Name, Description, IsActive, CreatedAt, UpdatedAt
      FROM Roles
      WHERE Name = @Name;
  - name: "GetActive"
    type: "Select"
    return: "many"
    description: "Obtiene todos los roles activos"
    sql: |
      SELECT Id, Name, Description, IsActive, CreatedAt, UpdatedAt
      FROM Roles
      WHERE IsActive = 1
      ORDER BY Name ASC;
  - name: "GetActiveCount"
    type: "Select"
    return: "scalar"
    description: "Obtiene el conteo de roles activos"
    sql: |
      SELECT COUNT(*)
      FROM Roles
      WHERE IsActive = 1;
  - name: "SetActiveStatus"
    type: "Update"
    return: "nothing"
    description: "Activa o desactiva un rol"
    sql: |
      UPDATE Roles 
      SET IsActive = @IsActive,
          UpdatedAt = CURRENT_TIMESTAMP_UTC
      WHERE Id = @Id;