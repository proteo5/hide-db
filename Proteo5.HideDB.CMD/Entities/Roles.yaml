# Description: This file defines the Roles entity for the Proteo5.HideDB.CMD project.
entity: "Roles"
entityversion: "1"
version: "1.0"
description: "Entity for system role management"

fields:
  - name: "Id"
    type: "int"
    primaryKey: true
    autoIncrement: true
    required: true
    nullable: false
    description: "Unique role identifier"
  - name: "Name"
    type: "string"
    maxLength: 50
    required: true
    nullable: false
    description: "Role name"
  - name: "Description"
    type: "string"
    maxLength: 255
    required: false
    nullable: true
    description: "Role description"
  - name: "IsActive"
    type: "bool"
    defaultValue: "true"
    required: true
    nullable: false
    description: "Indicates if the role is active"
  - name: "CreatedAt"
    type: "DateTime"
    defaultValue: "CURRENT_TIMESTAMP_UTC"
    required: true
    nullable: false
    description: "Creation date"
  - name: "UpdatedAt"
    type: "DateTime"
    defaultValue: "CURRENT_TIMESTAMP_UTC"
    required: true
    nullable: false
    description: "Last update date"

statements:
  - name: "Insert"
    type: "Insert"
    return: "nothing"
    description: "Create a new role"
    sql: |
      INSERT INTO Roles (Name, Description, IsActive)
      VALUES (@Name, @Description, @IsActive);
  - name: "Update"
    type: "Update"
    return: "nothing"
    description: "Update an existing role"
    sql: |
      UPDATE Roles 
      SET Name = @Name,
          Description = @Description,
          IsActive = @IsActive,
          UpdatedAt = CURRENT_TIMESTAMP_UTC
      WHERE Id = @Id;
  - name: "DeleteById"
    type: "Delete"
    return: "nothing"
    description: "Delete a role by ID"
    sql: |
      DELETE FROM Roles 
      WHERE Id = @Id;
  - name: "GetAll"
    type: "Select"
    return: "many"
    description: "Get all roles ordered by name"
    sql: |
      SELECT Id, Name, Description, IsActive, CreatedAt, UpdatedAt
      FROM Roles
      ORDER BY Name ASC;
  - name: "GetById"
    type: "Select"
    return: "one"
    description: "Get a role by ID"
    sql: |
      SELECT Id, Name, Description, IsActive, CreatedAt, UpdatedAt
      FROM Roles
      WHERE Id = @Id;
  - name: "GetByName"
    type: "Select"
    return: "one"
    description: "Get a role by name"
    sql: |
      SELECT Id, Name, Description, IsActive, CreatedAt, UpdatedAt
      FROM Roles
      WHERE Name = @Name;
  - name: "GetActive"
    type: "Select"
    return: "many"
    description: "Get all active roles"
    sql: |
      SELECT Id, Name, Description, IsActive, CreatedAt, UpdatedAt
      FROM Roles
      WHERE IsActive = 1
      ORDER BY Name ASC;
  - name: "GetActiveCount"
    type: "Select"
    return: "scalar"
    description: "Get count of active roles"
    sql: |
      SELECT COUNT(*)
      FROM Roles
      WHERE IsActive = 1;
  - name: "SetActiveStatus"
    type: "Update"
    return: "nothing"
    description: "Activate or deactivate a role"
    sql: |
      UPDATE Roles 
      SET IsActive = @IsActive,
          UpdatedAt = CURRENT_TIMESTAMP_UTC
      WHERE Id = @Id;